"use strict";var ae=Object.create;var A=Object.defineProperty;var fe=Object.getOwnPropertyDescriptor;var ye=Object.getOwnPropertyNames;var he=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty;var ue=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports),pe=(e,o)=>{for(var i in o)A(e,i,{get:o[i],enumerable:!0})},G=(e,o,i,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of ye(o))!me.call(e,n)&&n!==i&&A(e,n,{get:()=>o[n],enumerable:!(c=fe(o,n))||c.enumerable});return e};var De=(e,o,i)=>(i=e!=null?ae(he(e)):{},G(o||!e||!e.__esModule?A(i,"default",{value:e,enumerable:!0}):i,e)),de=e=>G(A({},"__esModule",{value:!0}),e);var J=ue(O=>{"use strict";var Te="array",Se="bit",K="bits",ge="byte",U="bytes",h="",be="exponent",Pe="function",I="iec",Fe="Invalid number",we="Invalid rounding method",P="jedec",ke="object",W=".",Z="round",Ae="s",Ie="kbit",Be="kB",_=" ",j="string",Ce="0",x={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function V(e,{bits:o=!1,pad:i=!1,base:c=-1,round:n=2,locale:a=h,localeOptions:f={},separator:u=h,spacer:T=_,symbols:S={},standard:y=h,output:g=j,fullform:$=!1,fullforms:F=[],exponent:w=-1,roundingMethod:E=Z,precision:D=0}={}){let l=w,d=Number(e),s=[],p=0,v=h;c===-1&&y.length===0?(c=10,y=P):c===-1&&y.length>0?(y=y===I?I:P,c=y===I?2:10):(c=c===2?2:10,y=c===10||y===P?P:I);let k=c===10?1e3:1024,ce=$===!0,N=d<0,L=Math[E];if(typeof e!="bigint"&&isNaN(e))throw new TypeError(Fe);if(typeof L!==Pe)throw new TypeError(we);if(N&&(d=-d),(l===-1||isNaN(l))&&(l=Math.floor(Math.log(d)/Math.log(k)),l<0&&(l=0)),l>8&&(D>0&&(D+=8-l),l=8),g===be)return l;if(d===0)s[0]=0,v=s[1]=x.symbol[y][o?K:U][l];else{p=d/(c===2?Math.pow(2,l*10):Math.pow(1e3,l)),o&&(p=p*8,p>=k&&l<8&&(p=p/k,l++));let b=Math.pow(10,l>0?n:0);s[0]=L(p*b)/b,s[0]===k&&l<8&&w===-1&&(s[0]=1,l++),v=s[1]=c===10&&l===1?o?Ie:Be:x.symbol[y][o?K:U][l]}if(N&&(s[0]=-s[0]),D>0&&(s[0]=s[0].toPrecision(D)),s[1]=S[s[1]]||s[1],a===!0?s[0]=s[0].toLocaleString():a.length>0?s[0]=s[0].toLocaleString(a,f):u.length>0&&(s[0]=s[0].toString().replace(W,u)),i&&Number.isInteger(s[0])===!1&&n>0){let b=u||W,z=s[0].toString().split(b),R=z[1]||h,Y=R.length,le=n-Y;s[0]=`${z[0]}${b}${R.padEnd(Y+le,Ce)}`}return ce&&(s[1]=F[l]?F[l]:x.fullform[y][l]+(o?Se:ge)+(s[0]===1?h:Ae)),g===Te?s:g===ke?{value:s[0],symbol:s[1],exponent:l,unit:v}:s.join(T)}function $e({bits:e=!1,pad:o=!1,base:i=-1,round:c=2,locale:n=h,localeOptions:a={},separator:f=h,spacer:u=_,symbols:T={},standard:S=h,output:y=j,fullform:g=!1,fullforms:$=[],exponent:F=-1,roundingMethod:w=Z,precision:E=0}={}){return D=>V(D,{bits:e,pad:o,base:i,round:c,locale:n,localeOptions:a,separator:f,spacer:u,symbols:T,standard:S,output:y,fullform:g,fullforms:$,exponent:F,roundingMethod:w,precision:E})}O.filesize=V;O.partial=$e});var Ne={};pe(Ne,{default:()=>se});module.exports=de(Ne);var t=require("@raycast/api"),H=require("node:util"),X=require("node:child_process"),q=De(J()),m=require("node:fs"),Q=require("node:path"),ee=require("node:os"),te=require("react"),r=require("react/jsx-runtime"),Ee=(0,H.promisify)(X.exec);async function ie(e,o,i){let c={title:"Permanently Delete File?",message:`Are you sure you want to delete ${o}? This action cannot be undone.`,icon:t.Icon.Eraser,primaryAction:{title:"Delete",style:t.Alert.ActionStyle.Destructive,onAction:async()=>{await re(`rm -rf "${e}"`),i(),(0,t.showToast)(t.Toast.Style.Success,"File Deleted",`${o}`)}}};await(0,t.confirmAlert)(c)}async function oe(e,o,i){let c={title:"Permanently Delete Directory?",message:`Are you sure you want to delete ${o}? This action cannot be undone.`,icon:t.Icon.Eraser,primaryAction:{title:"Delete",style:t.Alert.ActionStyle.Destructive,onAction:async()=>{await re(`rm -rf "${e}"`),i(),(0,t.showToast)(t.Toast.Style.Success,"Directory Deleted",`${o}`)}}};await(0,t.confirmAlert)(c)}function ve(e,o){return e.showFileSize?String((0,q.filesize)(o.size,{round:0,spacer:""})):""}async function re(e){let{stdout:o,stderr:i}=await Ee(e);return{stdout:o,stderr:i}}function ne(){let{startDirectory:e}=(0,t.getPreferenceValues)();return e=e.replace("~",(0,ee.homedir)()),(0,Q.resolve)(e)}function xe(e){let o=(0,t.getPreferenceValues)(),i=`${e.fileData.path}/${e.fileData.name}`;return(0,r.jsx)(t.List.Item,{id:i,title:e.fileData.name,subtitle:o.showFilePermissions?e.fileData.permissions:"",icon:{fileIcon:i},actions:(0,r.jsxs)(t.ActionPanel,{children:[(0,r.jsx)(t.Action.Push,{title:"Open Directory",icon:t.Icon.ArrowRight,target:(0,r.jsx)(C,{path:i})}),(0,r.jsx)(t.Action.ShowInFinder,{path:i}),(0,r.jsx)(t.Action.CopyToClipboard,{title:"Copy Directory Path",content:`${i}/`,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,r.jsx)(t.Action.Trash,{title:"Move to Trash",shortcut:{modifiers:["cmd"],key:"t"},paths:i,onTrash:()=>{(0,t.showToast)(t.Toast.Style.Success,"Moved to Trash",`Directory: ${i}`),e.refresh()}}),o.showDeleteActions&&(0,r.jsx)(t.Action,{title:"Delete Directory",icon:t.Icon.Trash,style:t.Action.Style.Destructive,shortcut:{modifiers:["cmd"],key:"d"},onAction:()=>oe(i,e.fileData.name,e.refresh)})]})})}function Oe(e){let o=(0,t.getPreferenceValues)(),i=`${e.fileData.path}/${e.fileData.name}`;return(0,r.jsx)(t.List.Item,{id:i,title:e.fileData.name,icon:{fileIcon:i},subtitle:o.showFilePermissions?e.fileData.permissions:"",accessories:[{icon:t.Icon.HardDrive,text:ve(o,e.fileData)}],actions:(0,r.jsxs)(t.ActionPanel,{children:[(0,r.jsx)(t.Action.Open,{title:"Open File",target:i}),(0,r.jsx)(t.Action.ShowInFinder,{path:i}),(0,r.jsx)(t.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}}),(0,r.jsx)(t.Action.CopyToClipboard,{title:"Copy File Path",content:i,shortcut:{modifiers:["opt","shift"],key:"c"}}),(0,r.jsx)(t.Action.Trash,{title:"Move to Trash",shortcut:{modifiers:["cmd"],key:"t"},paths:i,onTrash:()=>{(0,t.showToast)(t.Toast.Style.Success,"Moved to Trash",`File: ${i}`),e.refresh()}}),o.showDeleteActions&&(0,r.jsx)(t.Action,{title:"Delete File",icon:t.Icon.Trash,style:t.Action.Style.Destructive,shortcut:{modifiers:["cmd"],key:"d"},onAction:()=>ie(i,e.fileData.name,e.refresh)})]})},i)}function Me(e){let o=(0,t.getPreferenceValues)(),i=`${e.fileData.path}/${e.fileData.name}`,c=(0,m.readlinkSync)(i),n=c.startsWith("/")?c:`${e.fileData.path}/${c}`,a=(0,m.lstatSync)(n,{throwIfNoEntry:!1});return a?.isDirectory()??!1?(0,r.jsx)(t.List.Item,{id:i,title:e.fileData.name,icon:{fileIcon:i},subtitle:o.showFilePermissions?e.fileData.permissions:"",actions:(0,r.jsxs)(t.ActionPanel,{children:[(0,r.jsx)(t.Action.Push,{title:"Open Symlink Directory",icon:t.Icon.ArrowRight,target:(0,r.jsx)(C,{path:n})}),(0,r.jsx)(t.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}}),(0,r.jsx)(t.Action.CopyToClipboard,{title:"Copy Symlink Path",content:i,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,r.jsx)(t.Action.CopyToClipboard,{title:"Copy Original Directory Path",content:i,shortcut:{modifiers:["cmd","opt"],key:"c"}}),o.showDeleteActions&&(0,r.jsx)(t.Action,{title:"Delete Symlink Directory",icon:t.Icon.Trash,style:t.Action.Style.Destructive,shortcut:{modifiers:["cmd"],key:"d"},onAction:()=>oe(i,e.fileData.name,e.refresh)})]})}):(0,r.jsx)(t.List.Item,{id:i,title:e.fileData.name,icon:{fileIcon:i},subtitle:o.showFilePermissions?e.fileData.permissions:"",accessories:a?[]:[{icon:{source:t.Icon.ExclamationMark,tintColor:t.Color.Red},tooltip:"Broken Symlink"}],actions:(0,r.jsxs)(t.ActionPanel,{children:[a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.Action.Open,{title:"Open File",target:n}),(0,r.jsx)(t.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}})]}),(0,r.jsx)(t.Action.CopyToClipboard,{title:"Copy Symlink Path",content:i,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,r.jsx)(t.Action.CopyToClipboard,{title:"Copy Original File Path",content:n,shortcut:{modifiers:["cmd","opt"],key:"c"}}),o.showDeleteActions&&(0,r.jsx)(t.Action,{title:"Delete Symlink File",icon:t.Icon.Trash,style:t.Action.Style.Destructive,shortcut:{modifiers:["cmd"],key:"d"},onAction:()=>ie(i,e.fileData.name,e.refresh)})]})})}function M(e,o){let i=`${e.path}/${e.name}`;if(e.type==="directory")return(0,r.jsx)(xe,{fileData:e,refresh:o},i);if(e.type==="file")return(0,r.jsx)(Oe,{fileData:e,refresh:o},i);if(e.type==="symlink")return(0,r.jsx)(Me,{fileData:e,refresh:o},i);(0,t.showToast)(t.Toast.Style.Failure,"Unsupported file type",`File type: ${e.type}`)}function B(e){let o=(0,t.getPreferenceValues)(),i=(0,m.readdirSync)(e);o.showDots||(i=i.filter(n=>!n.startsWith("."))),o.caseSensitive||(i=i.sort((n,a)=>n.toLowerCase()<a.toLowerCase()?-1:n.toLowerCase()>a.toLowerCase()?1:0));let c=[];for(let n of i){let a=(0,m.lstatSync)(`${e}/${n}`),f="other";a.isDirectory()&&(f="directory"),a.isFile()&&(f="file"),a.isSymbolicLink()&&(f="symlink");let u=(a.mode&parseInt("777",8)).toString(8),T=a.size,S={type:f,name:n,size:T,permissions:u,path:e};c.push(S)}return c}function C(e){if(!(0,m.existsSync)(e.path))return(0,r.jsx)(t.Detail,{markdown:`# Error: 

The directory \`${e.path}\` does not exist. `});let[o,i]=(0,te.useState)(()=>B(e.path));if((0,t.getPreferenceValues)().directoriesFirst){let n=o.filter(f=>f.type==="directory"),a=o.filter(f=>f.type!=="directory");return(0,r.jsxs)(t.List,{searchBarPlaceholder:`Search in ${e.path}/`,children:[(0,r.jsx)(t.List.Section,{title:"Directories",children:n.map(f=>M(f,()=>i(B(e.path))))}),(0,r.jsx)(t.List.Section,{title:"Files",children:a.map(f=>M(f,()=>i(B(e.path))))})]})}else return(0,r.jsx)(t.List,{searchBarPlaceholder:`Search in ${e.path}/`,children:o.map(n=>M(n,()=>i(B(e.path))))})}var Le=require("react/jsx-runtime");function se(){return(0,Le.jsx)(C,{path:ne()})}0&&(module.exports={});
/**
 * filesize
 *
 * @copyright 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 10.0.7
 */

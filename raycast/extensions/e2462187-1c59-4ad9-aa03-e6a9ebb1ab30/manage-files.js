"use strict";var fe=Object.create;var I=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var he=Object.getOwnPropertyNames;var me=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty;var de=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),De=(e,r)=>{for(var i in r)I(e,i,{get:r[i],enumerable:!0})},W=(e,r,i,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of he(r))!ue.call(e,s)&&s!==i&&I(e,s,{get:()=>r[s],enumerable:!(n=ye(r,s))||n.enumerable});return e};var pe=(e,r,i)=>(i=e!=null?fe(me(e)):{},W(r||!e||!e.__esModule?I(i,"default",{value:e,enumerable:!0}):i,e)),Se=e=>W(I({},"__esModule",{value:!0}),e);var q=de(O=>{"use strict";var ge="array",Pe="bit",Z="bits",Te="byte",_="bytes",h="",be="exponent",Fe="function",$="iec",ke="Invalid number",we="Invalid rounding method",F="jedec",Ae="object",j=".",V="round",Ie="s",$e="kbit",xe="kB",J=" ",H="string",Ce="0",N={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function X(e,{bits:r=!1,pad:i=!1,base:n=-1,round:s=2,locale:a=h,localeOptions:f={},separator:d=h,spacer:g=J,symbols:P={},standard:y=h,output:T=H,fullform:E=!1,fullforms:k=[],exponent:w=-1,roundingMethod:B=V,precision:p=0}={}){let l=w,S=Number(e),c=[],D=0,v=h;n===-1&&y.length===0?(n=10,y=F):n===-1&&y.length>0?(y=y===$?$:F,n=y===$?2:10):(n=n===2?2:10,y=n===10||y===F?F:$);let A=n===10?1e3:1024,ae=E===!0,z=S<0,Y=Math[B];if(typeof e!="bigint"&&isNaN(e))throw new TypeError(ke);if(typeof Y!==Fe)throw new TypeError(we);if(z&&(S=-S),(l===-1||isNaN(l))&&(l=Math.floor(Math.log(S)/Math.log(A)),l<0&&(l=0)),l>8&&(p>0&&(p+=8-l),l=8),T===be)return l;if(S===0)c[0]=0,v=c[1]=N.symbol[y][r?Z:_][l];else{D=S/(n===2?Math.pow(2,l*10):Math.pow(1e3,l)),r&&(D=D*8,D>=A&&l<8&&(D=D/A,l++));let b=Math.pow(10,l>0?s:0);c[0]=Y(D*b)/b,c[0]===A&&l<8&&w===-1&&(c[0]=1,l++),v=c[1]=n===10&&l===1?r?$e:xe:N.symbol[y][r?Z:_][l]}if(z&&(c[0]=-c[0]),p>0&&(c[0]=c[0].toPrecision(p)),c[1]=P[c[1]]||c[1],a===!0?c[0]=c[0].toLocaleString():a.length>0?c[0]=c[0].toLocaleString(a,f):d.length>0&&(c[0]=c[0].toString().replace(j,d)),i&&Number.isInteger(c[0])===!1&&s>0){let b=d||j,G=c[0].toString().split(b),K=G[1]||h,U=K.length,le=s-U;c[0]=`${G[0]}${b}${K.padEnd(U+le,Ce)}`}return ae&&(c[1]=k[l]?k[l]:N.fullform[y][l]+(r?Pe:Te)+(c[0]===1?h:Ie)),T===ge?c:T===Ae?{value:c[0],symbol:c[1],exponent:l,unit:v}:c.join(g)}function Ee({bits:e=!1,pad:r=!1,base:i=-1,round:n=2,locale:s=h,localeOptions:a={},separator:f=h,spacer:d=J,symbols:g={},standard:P=h,output:y=H,fullform:T=!1,fullforms:E=[],exponent:k=-1,roundingMethod:w=V,precision:B=0}={}){return p=>X(p,{bits:e,pad:r,base:i,round:n,locale:s,localeOptions:a,separator:f,spacer:d,symbols:g,standard:P,output:y,fullform:T,fullforms:E,exponent:k,roundingMethod:w,precision:B})}O.filesize=X;O.partial=Ee});var Re={};De(Re,{default:()=>ce});module.exports=Se(Re);var t=require("@raycast/api"),Q=require("node:util"),ee=require("node:child_process"),te=pe(q()),m=require("node:fs"),u=require("node:path"),ie=require("node:os"),R=require("react"),o=require("react/jsx-runtime"),Be=(0,Q.promisify)(ee.exec);async function re(e,r,i){let n={title:"Permanently Delete File?",message:`Are you sure you want to delete ${r}? This action cannot be undone.`,icon:t.Icon.Eraser,primaryAction:{title:"Delete",style:t.Alert.ActionStyle.Destructive,onAction:async()=>{await L(`rm -rf "${e}"`),i(),(0,t.showToast)(t.Toast.Style.Success,"File Deleted",`${r}`)}}};await(0,t.confirmAlert)(n)}async function oe(e,r,i){let n={title:"Permanently Delete Directory?",message:`Are you sure you want to delete ${r}? This action cannot be undone.`,icon:t.Icon.Eraser,primaryAction:{title:"Delete",style:t.Alert.ActionStyle.Destructive,onAction:async()=>{await L(`rm -rf "${e}"`),i(),(0,t.showToast)(t.Toast.Style.Success,"Directory Deleted",`${r}`)}}};await(0,t.confirmAlert)(n)}function ve(e,r){return e.showFileSize?String((0,te.filesize)(r.size,{round:0,spacer:""})):""}async function L(e){let{stdout:r,stderr:i}=await Be(e);return{stdout:r,stderr:i}}function ne(){let{startDirectory:e}=(0,t.getPreferenceValues)();return e=e.replace("~",(0,ie.homedir)()),(0,u.resolve)(e)}function Ne(e){let r=(0,t.getPreferenceValues)(),i=`${e.fileData.path}/${e.fileData.name}`;return(0,o.jsx)(t.List.Item,{id:i,title:e.fileData.name,subtitle:r.showFilePermissions?e.fileData.permissions:"",icon:{fileIcon:i},actions:(0,o.jsxs)(t.ActionPanel,{children:[(0,o.jsx)(t.Action.Push,{title:"Open Directory",icon:t.Icon.ArrowRight,target:(0,o.jsx)(C,{path:i})}),(0,o.jsx)(t.Action.ShowInFinder,{path:i}),(0,o.jsx)(t.Action.CopyToClipboard,{title:"Copy Directory Path",content:`${i}/`,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,o.jsx)(t.Action.Push,{target:(0,o.jsx)(se,{filePath:i,refresh:e.refresh,isDirectory:!0}),title:"Rename Directory",shortcut:{modifiers:["cmd"],key:"r"},icon:t.Icon.Pencil}),(0,o.jsxs)(t.ActionPanel.Section,{children:[(0,o.jsx)(t.Action.Trash,{title:"Move to Trash",shortcut:r.standardShortcuts?{modifiers:["ctrl"],key:"x"}:{modifiers:["cmd"],key:"t"},paths:i,onTrash:()=>{(0,t.showToast)(t.Toast.Style.Success,"Moved to Trash",`Directory: ${i}`),e.refresh()}}),r.showDeleteActions&&(0,o.jsx)(t.Action,{title:"Delete Directory",icon:t.Icon.Eraser,style:t.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>oe(i,e.fileData.name,e.refresh)})]})]})})}function Oe(e){let r=(0,t.getPreferenceValues)(),i=`${e.fileData.path}/${e.fileData.name}`;return(0,o.jsx)(t.List.Item,{id:i,title:e.fileData.name,icon:{fileIcon:i},subtitle:r.showFilePermissions?e.fileData.permissions:"",accessories:[{icon:t.Icon.HardDrive,text:ve(r,e.fileData)}],actions:(0,o.jsxs)(t.ActionPanel,{children:[(0,o.jsx)(t.Action.Open,{title:"Open File",target:i}),(0,o.jsx)(t.Action.ShowInFinder,{path:i}),(0,o.jsx)(t.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}}),(0,o.jsx)(t.Action.CopyToClipboard,{title:"Copy File Path",content:i,shortcut:{modifiers:["opt","shift"],key:"c"}}),(0,o.jsx)(t.Action.Push,{target:(0,o.jsx)(se,{filePath:i,refresh:e.refresh,isDirectory:!1}),title:"Rename File",icon:t.Icon.Pencil,shortcut:{modifiers:["cmd"],key:"r"}}),(0,o.jsxs)(t.ActionPanel.Section,{children:[(0,o.jsx)(t.Action.Trash,{title:"Move to Trash",shortcut:r.standardShortcuts?{modifiers:["ctrl"],key:"x"}:{modifiers:["cmd"],key:"t"},paths:i,onTrash:()=>{(0,t.showToast)(t.Toast.Style.Success,"Moved to Trash",`File: ${i}`),e.refresh()}}),r.showDeleteActions&&(0,o.jsx)(t.Action,{title:"Delete File",icon:t.Icon.Eraser,style:t.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>re(i,e.fileData.name,e.refresh)})]})]})},i)}function Me(e){let r=(0,t.getPreferenceValues)(),i=`${e.fileData.path}/${e.fileData.name}`,n=(0,m.readlinkSync)(i),s=n.startsWith("/")?n:`${e.fileData.path}/${n}`,a=(0,m.lstatSync)(s,{throwIfNoEntry:!1});return a?.isDirectory()??!1?(0,o.jsx)(t.List.Item,{id:i,title:e.fileData.name,icon:{fileIcon:i},subtitle:r.showFilePermissions?e.fileData.permissions:"",actions:(0,o.jsxs)(t.ActionPanel,{children:[(0,o.jsx)(t.Action.Push,{title:"Open Symlink Directory",icon:t.Icon.ArrowRight,target:(0,o.jsx)(C,{path:s})}),(0,o.jsx)(t.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}}),(0,o.jsx)(t.Action.CopyToClipboard,{title:"Copy Symlink Path",content:i,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,o.jsx)(t.Action.CopyToClipboard,{title:"Copy Original Directory Path",content:i,shortcut:{modifiers:["cmd","opt"],key:"c"}}),r.showDeleteActions&&(0,o.jsx)(t.Action,{title:"Delete Symlink Directory",icon:t.Icon.Eraser,style:t.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>oe(i,e.fileData.name,e.refresh)})]})}):(0,o.jsx)(t.List.Item,{id:i,title:e.fileData.name,icon:{fileIcon:i},subtitle:r.showFilePermissions?e.fileData.permissions:"",accessories:a?[]:[{icon:{source:t.Icon.ExclamationMark,tintColor:t.Color.Red},tooltip:"Broken Symlink"}],actions:(0,o.jsxs)(t.ActionPanel,{children:[a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.Action.Open,{title:"Open File",target:s}),(0,o.jsx)(t.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}})]}),(0,o.jsx)(t.Action.CopyToClipboard,{title:"Copy Symlink Path",content:i,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,o.jsx)(t.Action.CopyToClipboard,{title:"Copy Original File Path",content:s,shortcut:{modifiers:["cmd","opt"],key:"c"}}),r.showDeleteActions&&(0,o.jsx)(t.Action,{title:"Delete Symlink File",icon:t.Icon.Eraser,style:t.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>re(i,e.fileData.name,e.refresh)})]})})}function M(e,r){let i=`${e.path}/${e.name}`;if(e.type==="directory")return(0,o.jsx)(Ne,{fileData:e,refresh:r},i);if(e.type==="file")return(0,o.jsx)(Oe,{fileData:e,refresh:r},i);if(e.type==="symlink")return(0,o.jsx)(Me,{fileData:e,refresh:r},i);(0,t.showToast)(t.Toast.Style.Failure,"Unsupported file type",`File type: ${e.type}`)}function x(e){let r=(0,t.getPreferenceValues)(),i=(0,m.readdirSync)(e);r.showDots||(i=i.filter(s=>!s.startsWith("."))),r.caseSensitive||(i=i.sort((s,a)=>s.toLowerCase()<a.toLowerCase()?-1:s.toLowerCase()>a.toLowerCase()?1:0));let n=[];for(let s of i){let a=(0,m.lstatSync)(`${e}/${s}`),f="other";a.isDirectory()&&(f="directory"),a.isFile()&&(f="file"),a.isSymbolicLink()&&(f="symlink");let d=(a.mode&parseInt("777",8)).toString(8),g=a.size,P={type:f,name:s,size:g,permissions:d,path:e};n.push(P)}return n}function C(e){if(!(0,m.existsSync)(e.path))return(0,o.jsx)(t.Detail,{markdown:`# Error: 

The directory \`${e.path}\` does not exist. `});let[r,i]=(0,R.useState)(()=>x(e.path));if((0,t.getPreferenceValues)().directoriesFirst){let s=r.filter(f=>f.type==="directory"),a=r.filter(f=>f.type!=="directory");return(0,o.jsxs)(t.List,{searchBarPlaceholder:`Search in ${e.path}/`,children:[(0,o.jsx)(t.List.Section,{title:"Directories",children:s.map(f=>M(f,()=>i(x(e.path))))}),(0,o.jsx)(t.List.Section,{title:"Files",children:a.map(f=>M(f,()=>i(x(e.path))))})]})}else return(0,o.jsx)(t.List,{searchBarPlaceholder:`Search in ${e.path}/`,children:r.map(s=>M(s,()=>i(x(e.path))))})}function se(e){let[r,i]=(0,R.useState)((0,u.basename)(e.filePath)),{pop:n}=(0,t.useNavigation)();async function s(){let a=`${(0,u.dirname)(e.filePath)}/${r}`;e.filePath!==a&&(await L(`mv "${e.filePath}" "${a}"`),(0,t.showToast)(t.Toast.Style.Success,`${e.isDirectory?"Directory":"File"} Renamed`,`${(0,u.basename)(e.filePath)} -> ${r}`),e.refresh(),n())}return(0,o.jsx)(t.Form,{navigationTitle:(0,u.basename)(e.filePath),actions:(0,o.jsxs)(t.ActionPanel,{children:[(0,o.jsx)(t.Action,{title:`Rename ${e.isDirectory?"Directory":"File"}`,onAction:s,icon:t.Icon.Pencil}),(0,o.jsx)(t.Action,{title:"Cancel",shortcut:{modifiers:["cmd"],key:"."},onAction:n,icon:t.Icon.Undo})]}),children:(0,o.jsx)(t.Form.TextField,{id:"itemName",title:`Rename ${e.isDirectory?"Directory":"File"}`,placeholder:"Enter new name",value:r,onChange:i})})}var Le=require("react/jsx-runtime");function ce(){return(0,Le.jsx)(C,{path:ne()})}0&&(module.exports={});
/**
 * filesize
 *
 * @copyright 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 10.0.7
 */

"use strict";var ye=Object.create;var I=Object.defineProperty;var he=Object.getOwnPropertyDescriptor;var me=Object.getOwnPropertyNames;var ue=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty;var De=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),pe=(t,r)=>{for(var i in r)I(t,i,{get:r[i],enumerable:!0})},W=(t,r,i,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of me(r))!de.call(t,s)&&s!==i&&I(t,s,{get:()=>r[s],enumerable:!(n=he(r,s))||n.enumerable});return t};var Se=(t,r,i)=>(i=t!=null?ye(ue(t)):{},W(r||!t||!t.__esModule?I(i,"default",{value:t,enumerable:!0}):i,t)),ge=t=>W(I({},"__esModule",{value:!0}),t);var q=De(N=>{"use strict";var Pe="array",Te="bit",Z="bits",be="byte",_="bytes",h="",Fe="exponent",ke="function",$="iec",we="Invalid number",Ae="Invalid rounding method",F="jedec",Ie="object",j=".",V="round",$e="s",xe="kbit",Ce="kB",J=" ",H="string",Be="0",O={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function X(t,{bits:r=!1,pad:i=!1,base:n=-1,round:s=2,locale:a=h,localeOptions:f={},separator:d=h,spacer:g=J,symbols:P={},standard:y=h,output:T=H,fullform:B=!1,fullforms:k=[],exponent:w=-1,roundingMethod:E=V,precision:p=0}={}){let l=w,S=Number(t),c=[],D=0,v=h;n===-1&&y.length===0?(n=10,y=F):n===-1&&y.length>0?(y=y===$?$:F,n=y===$?2:10):(n=n===2?2:10,y=n===10||y===F?F:$);let A=n===10?1e3:1024,le=B===!0,z=S<0,Y=Math[E];if(typeof t!="bigint"&&isNaN(t))throw new TypeError(we);if(typeof Y!==ke)throw new TypeError(Ae);if(z&&(S=-S),(l===-1||isNaN(l))&&(l=Math.floor(Math.log(S)/Math.log(A)),l<0&&(l=0)),l>8&&(p>0&&(p+=8-l),l=8),T===Fe)return l;if(S===0)c[0]=0,v=c[1]=O.symbol[y][r?Z:_][l];else{D=S/(n===2?Math.pow(2,l*10):Math.pow(1e3,l)),r&&(D=D*8,D>=A&&l<8&&(D=D/A,l++));let b=Math.pow(10,l>0?s:0);c[0]=Y(D*b)/b,c[0]===A&&l<8&&w===-1&&(c[0]=1,l++),v=c[1]=n===10&&l===1?r?xe:Ce:O.symbol[y][r?Z:_][l]}if(z&&(c[0]=-c[0]),p>0&&(c[0]=c[0].toPrecision(p)),c[1]=P[c[1]]||c[1],a===!0?c[0]=c[0].toLocaleString():a.length>0?c[0]=c[0].toLocaleString(a,f):d.length>0&&(c[0]=c[0].toString().replace(j,d)),i&&Number.isInteger(c[0])===!1&&s>0){let b=d||j,G=c[0].toString().split(b),K=G[1]||h,U=K.length,fe=s-U;c[0]=`${G[0]}${b}${K.padEnd(U+fe,Be)}`}return le&&(c[1]=k[l]?k[l]:O.fullform[y][l]+(r?Te:be)+(c[0]===1?h:$e)),T===Pe?c:T===Ie?{value:c[0],symbol:c[1],exponent:l,unit:v}:c.join(g)}function Ee({bits:t=!1,pad:r=!1,base:i=-1,round:n=2,locale:s=h,localeOptions:a={},separator:f=h,spacer:d=J,symbols:g={},standard:P=h,output:y=H,fullform:T=!1,fullforms:B=[],exponent:k=-1,roundingMethod:w=V,precision:E=0}={}){return p=>X(p,{bits:t,pad:r,base:i,round:n,locale:s,localeOptions:a,separator:f,spacer:d,symbols:g,standard:P,output:y,fullform:T,fullforms:B,exponent:k,roundingMethod:w,precision:E})}N.filesize=X;N.partial=Ee});var Le={};pe(Le,{default:()=>ce});module.exports=ge(Le);var e=require("@raycast/api"),Q=require("node:util"),ee=require("node:child_process"),te=Se(q()),m=require("node:fs"),u=require("node:path"),ie=require("node:os"),M=require("react"),o=require("react/jsx-runtime"),ve=(0,Q.promisify)(ee.exec);async function re(t,r,i){let n={title:"Permanently Delete File?",message:`Are you sure you want to delete ${r}? This action cannot be undone.`,icon:e.Icon.Eraser,primaryAction:{title:"Delete",style:e.Alert.ActionStyle.Destructive,onAction:async()=>{await L(`rm -rf "${t}"`),i(),(0,e.showToast)(e.Toast.Style.Success,"File Deleted",`${r}`)}}};await(0,e.confirmAlert)(n)}async function oe(t,r,i){let n={title:"Permanently Delete Directory?",message:`Are you sure you want to delete ${r}? This action cannot be undone.`,icon:e.Icon.Eraser,primaryAction:{title:"Delete",style:e.Alert.ActionStyle.Destructive,onAction:async()=>{await L(`rm -rf "${t}"`),i(),(0,e.showToast)(e.Toast.Style.Success,"Directory Deleted",`${r}`)}}};await(0,e.confirmAlert)(n)}function Oe(t,r){return t.showFileSize?String((0,te.filesize)(r.size,{round:0,spacer:""})):""}async function L(t){let{stdout:r,stderr:i}=await ve(t);return{stdout:r,stderr:i}}function ne(){let{startDirectory:t}=(0,e.getPreferenceValues)();return t=t.replace("~",(0,ie.homedir)()),(0,u.resolve)(t)}function Ne(t){let r=(0,e.getPreferenceValues)(),i=`${t.fileData.path}/${t.fileData.name}`;return(0,o.jsx)(e.List.Item,{id:i,title:t.fileData.name,subtitle:r.showFilePermissions?t.fileData.permissions:"",icon:{fileIcon:i},actions:(0,o.jsxs)(e.ActionPanel,{children:[(0,o.jsx)(e.Action.Push,{title:"Open Directory",icon:e.Icon.ArrowRight,target:(0,o.jsx)(C,{path:i})}),(0,o.jsx)(e.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"},onOpen:()=>(0,e.popToRoot)({clearSearchBar:!0})}),(0,o.jsx)(e.Action.ShowInFinder,{path:i}),(0,o.jsx)(e.Action.CopyToClipboard,{title:"Copy Directory Path",content:`${i}/`,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,o.jsx)(e.Action.Push,{target:(0,o.jsx)(se,{filePath:i,refresh:t.refresh,isDirectory:!0}),title:"Rename Directory",shortcut:{modifiers:["cmd"],key:"r"},icon:e.Icon.Pencil}),(0,o.jsxs)(e.ActionPanel.Section,{children:[(0,o.jsx)(e.Action.Trash,{title:"Move to Trash",shortcut:r.standardShortcuts?{modifiers:["ctrl"],key:"x"}:{modifiers:["cmd"],key:"t"},paths:i,onTrash:()=>{(0,e.showToast)(e.Toast.Style.Success,"Moved to Trash",`Directory: ${i}`),t.refresh()}}),r.showDeleteActions&&(0,o.jsx)(e.Action,{title:"Delete Directory",icon:e.Icon.Eraser,style:e.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>oe(i,t.fileData.name,t.refresh)})]})]})})}function Re(t){let r=(0,e.getPreferenceValues)(),i=`${t.fileData.path}/${t.fileData.name}`;return(0,o.jsx)(e.List.Item,{id:i,title:t.fileData.name,icon:{fileIcon:i},subtitle:r.showFilePermissions?t.fileData.permissions:"",accessories:[{icon:e.Icon.HardDrive,text:Oe(r,t.fileData)}],actions:(0,o.jsxs)(e.ActionPanel,{children:[(0,o.jsx)(e.Action.Open,{title:"Open File",target:i}),(0,o.jsx)(e.Action.ShowInFinder,{path:i}),(0,o.jsx)(e.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}}),(0,o.jsx)(e.Action.CopyToClipboard,{title:"Copy File Path",content:i,shortcut:{modifiers:["opt","shift"],key:"c"}}),(0,o.jsx)(e.Action.Push,{target:(0,o.jsx)(se,{filePath:i,refresh:t.refresh,isDirectory:!1}),title:"Rename File",icon:e.Icon.Pencil,shortcut:{modifiers:["cmd"],key:"r"}}),(0,o.jsxs)(e.ActionPanel.Section,{children:[(0,o.jsx)(e.Action.Trash,{title:"Move to Trash",shortcut:r.standardShortcuts?{modifiers:["ctrl"],key:"x"}:{modifiers:["cmd"],key:"t"},paths:i,onTrash:()=>{(0,e.showToast)(e.Toast.Style.Success,"Moved to Trash",`File: ${i}`),t.refresh()}}),r.showDeleteActions&&(0,o.jsx)(e.Action,{title:"Delete File",icon:e.Icon.Eraser,style:e.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>re(i,t.fileData.name,t.refresh)})]})]})},i)}function Me(t){let r=(0,e.getPreferenceValues)(),i=`${t.fileData.path}/${t.fileData.name}`,n=(0,m.readlinkSync)(i),s=n.startsWith("/")?n:`${t.fileData.path}/${n}`,a=(0,m.lstatSync)(s,{throwIfNoEntry:!1});return a?.isDirectory()??!1?(0,o.jsx)(e.List.Item,{id:i,title:t.fileData.name,icon:{fileIcon:i},subtitle:r.showFilePermissions?t.fileData.permissions:"",actions:(0,o.jsxs)(e.ActionPanel,{children:[(0,o.jsx)(e.Action.Push,{title:"Open Symlink Directory",icon:e.Icon.ArrowRight,target:(0,o.jsx)(C,{path:s})}),(0,o.jsx)(e.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}}),(0,o.jsx)(e.Action.CopyToClipboard,{title:"Copy Symlink Path",content:i,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,o.jsx)(e.Action.CopyToClipboard,{title:"Copy Original Directory Path",content:i,shortcut:{modifiers:["cmd","opt"],key:"c"}}),r.showDeleteActions&&(0,o.jsx)(e.Action,{title:"Delete Symlink Directory",icon:e.Icon.Eraser,style:e.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>oe(i,t.fileData.name,t.refresh)})]})}):(0,o.jsx)(e.List.Item,{id:i,title:t.fileData.name,icon:{fileIcon:i},subtitle:r.showFilePermissions?t.fileData.permissions:"",accessories:a?[]:[{icon:{source:e.Icon.ExclamationMark,tintColor:e.Color.Red},tooltip:"Broken Symlink"}],actions:(0,o.jsxs)(e.ActionPanel,{children:[a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.Action.Open,{title:"Open File",target:s}),(0,o.jsx)(e.Action.OpenWith,{path:i,shortcut:{modifiers:["cmd"],key:"o"}})]}),(0,o.jsx)(e.Action.CopyToClipboard,{title:"Copy Symlink Path",content:i,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,o.jsx)(e.Action.CopyToClipboard,{title:"Copy Original File Path",content:s,shortcut:{modifiers:["cmd","opt"],key:"c"}}),r.showDeleteActions&&(0,o.jsx)(e.Action,{title:"Delete Symlink File",icon:e.Icon.Eraser,style:e.Action.Style.Destructive,shortcut:r.standardShortcuts?{modifiers:["ctrl","shift"],key:"x"}:{modifiers:["cmd"],key:"d"},onAction:()=>re(i,t.fileData.name,t.refresh)})]})})}function R(t,r){let i=`${t.path}/${t.name}`;if(t.type==="directory")return(0,o.jsx)(Ne,{fileData:t,refresh:r},i);if(t.type==="file")return(0,o.jsx)(Re,{fileData:t,refresh:r},i);if(t.type==="symlink")return(0,o.jsx)(Me,{fileData:t,refresh:r},i);(0,e.showToast)(e.Toast.Style.Failure,"Unsupported file type",`File type: ${t.type}`)}function x(t){let r=(0,e.getPreferenceValues)(),i=(0,m.readdirSync)(t);r.showDots||(i=i.filter(s=>!s.startsWith("."))),r.caseSensitive||(i=i.sort((s,a)=>s.toLowerCase()<a.toLowerCase()?-1:s.toLowerCase()>a.toLowerCase()?1:0));let n=[];for(let s of i){let a=(0,m.lstatSync)(`${t}/${s}`),f="other";a.isDirectory()&&(f="directory"),a.isFile()&&(f="file"),a.isSymbolicLink()&&(f="symlink");let d=(a.mode&parseInt("777",8)).toString(8),g=a.size,P={type:f,name:s,size:g,permissions:d,path:t};n.push(P)}return n}function C(t){if(!(0,m.existsSync)(t.path))return(0,o.jsx)(e.Detail,{markdown:`# Error: 

The directory \`${t.path}\` does not exist. `});let[r,i]=(0,M.useState)(()=>x(t.path));if((0,e.getPreferenceValues)().directoriesFirst){let s=r.filter(f=>f.type==="directory"),a=r.filter(f=>f.type!=="directory");return(0,o.jsxs)(e.List,{searchBarPlaceholder:`Search in ${t.path}/`,children:[(0,o.jsx)(e.List.Section,{title:"Directories",children:s.map(f=>R(f,()=>i(x(t.path))))}),(0,o.jsx)(e.List.Section,{title:"Files",children:a.map(f=>R(f,()=>i(x(t.path))))})]})}else return(0,o.jsx)(e.List,{searchBarPlaceholder:`Search in ${t.path}/`,children:r.map(s=>R(s,()=>i(x(t.path))))})}function se(t){let[r,i]=(0,M.useState)((0,u.basename)(t.filePath)),{pop:n}=(0,e.useNavigation)();async function s(){let a=`${(0,u.dirname)(t.filePath)}/${r}`;t.filePath!==a&&(await L(`mv "${t.filePath}" "${a}"`),(0,e.showToast)(e.Toast.Style.Success,`${t.isDirectory?"Directory":"File"} Renamed`,`${(0,u.basename)(t.filePath)} -> ${r}`),t.refresh(),n())}return(0,o.jsx)(e.Form,{navigationTitle:(0,u.basename)(t.filePath),actions:(0,o.jsxs)(e.ActionPanel,{children:[(0,o.jsx)(e.Action,{title:`Rename ${t.isDirectory?"Directory":"File"}`,onAction:s,icon:e.Icon.Pencil}),(0,o.jsx)(e.Action,{title:"Cancel",shortcut:{modifiers:["cmd"],key:"."},onAction:n,icon:e.Icon.Undo})]}),children:(0,o.jsx)(e.Form.TextField,{id:"itemName",title:`Rename ${t.isDirectory?"Directory":"File"}`,placeholder:"Enter new name",value:r,onChange:i})})}var ae=require("react/jsx-runtime");function ce(){return(0,ae.jsx)(C,{path:ne()})}
/*! Bundled license information:

filesize/dist/filesize.cjs:
  (**
   * filesize
   *
   * @copyright 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
   * @license BSD-3-Clause
   * @version 10.0.7
   *)
*/
